require(dplyr)
require(psych)
require(stringr)
require(caret)
require(data.table)

base_mais <- fread("C:/Users/mrrezende/Documents/Produto_Mais.txt")

base_mais$ClasseAtuarial <- if_else(
  base_mais$`Procedimento Codigo` %in% c("10101012","10101020",
                                       "10106146","20101201",
                                       "50000055","50000144",
                                       "50000349","50000462",
                                       "50000560","50000586"), 
                                          "1-Consultas Eletivas", 
  if_else(base_mais$`Procedimento Codigo` %in% c("10101039"),"2-Consulta PA",
          if_else(base_mais$`Procedimento Codigo` %in% c("20102020",
  "20102038","20202016","30202027","30713137","30713145","30724252",
  "30911044","30911079","30911095","31201040","31301029","31303021",
  "40101010","40101029","40101037","40101045","40102025","40102092",
  "40103064","40103072","40103080","40103099","40103102","40103137",
  "40103170","40103196","40103200","40103234","40103315","40103323",
  "40103331","40103439","40103455","40103463","40103480","40103498",
  "40103528","40103650","40103749","40103897","40105016","40105040",
  "40105075","40105083","40201023","40201031","40201058","40201066",
  "40201082","40201120","40201163","40201171","40201180","40201210",
  "40201228","40201236","40201252","40201260","40202038","40202615",
  "40202666","40301060","40301087","40301109","40301125","40301150",
  "40301168","40301222","40301230","40301249","40301257","40301273",
  "40301281","40301290","40301354","40301397","40301400","40301419",
  "40301427","40301478","40301508","40301559","40301567","40301583",
  "40301591","40301605","40301621","40301630","40301648","40301656",
  "40301664","40301672","40301680","40301729","40301761","40301788",
  "40301818","40301826","40301842","40301869","40301877","40301885",
  "40301931","40301958","40301974","40301990","40302016","40302032",
  "40302040","40302075","40302113","40302164","40302199","40302229",
  "40302237","40302245","40302270","40302288","40302300","40302318",
  "40302377","40302385","40302423","40302504","40302512","40302520",
  "40302547","40302571","40302580","40302601","40302636","40302695",
  "40302709","40302733","40302750","40302776","40302830","40303012",
  "40303039","40303055","40303098","40303110","40303128","40303136",
  "40303250","40304019","40304043","40304051","40304060","40304086",
  "40304094","40304108","40304264","40304280","40304299","40304337",
  "40304345","40304353","40304361","40304370","40304450","40304507",
  "40304558","40304582","40304590","40304620","40304639","40304787",
  "40304795","40304850","40304884","40304892","40304906","40304914",
  "40304922","40305015","40305112","40305210","40305228","40305287",
  "40305341","40305384","40305406","40305465","40305546","40305627",
  "40305759","40305767","40306062","40306089","40306097","40306100",
  "40306119","40306127","40306135","40306143","40306151","40306160",
  "40306208","40306259","40306305","40306313","40306348","40306356",
  "40306364","40306399","40306402","40306410","40306437","40306445",
  "40306470","40306488","40306500","40306593","40306607","40306615",
  "40306623","40306631","40306640","40306666","40306674","40306690",
  "40306704","40306712","40306739","40306747","40306771","40306798",
  "40306852","40306860","40306887","40306933","40306941","40306950",
  "40306968","40306976","40306984","40306992","40307018","40307026",
  "40307085","40307093","40307140","40307174","40307182","40307212",
  "40307220","40307255","40307263","40307271","40307280","40307301",
  "40307336","40307352","40307433","40307441","40307450","40307468",
  "40307476","40307573","40307581","40307697","40307700","40307735",
  "40307743","40307760","40307824","40307832","40307867","40307905",
  "40307964","40307972","40308014","40308030","40308154","40308162",
  "40308170","40308340","40308383","40308391","40308405","40308553",
  "40309037","40309045","40309053","40309100","40309150","40309169",
  "40309312","40310051","40310060","40310116","40310124","40310140",
  "40310159","40310175","40310183","40310213","40310230","40310248",
  "40310256","40310264","40310337","40310400","40310418","40310426",
  "40311015","40311058","40311104","40311163","40311171","40311210",
  "40311252","40311350","40312062","40312127","40312143","40312151",
  "40312160","40312178","40313018","40313107","40313115","40313190",
  "40313310","40313328","40314057","40314103","40314111","40314120",
  "40314154","40316017","40316033","40316041","40316050","40316068",
  "40316076","40316084","40316092","40316106","40316114","40316122",
  "40316130","40316149","40316157","40316165","40316173","40316190",
  "40316203","40316211","40316220","40316246","40316254","40316262",
  "40316270","40316289","40316300","40316319","40316327","40316335",
  "40316360","40316378","40316386","40316394","40316408","40316416",
  "40316424","40316432","40316440","40316459","40316467","40316483",
  "40316491","40316505","40316513","40316521","40316530","40316548",
  "40316556","40316572","40316955","40319288","40324176","40324559",
  "40324567","40403173","40403408","40403424","40403440","40403467",
  "40403483","40403505","40403602","40403661","40501019","40501043",
  "40501051","40502082","40601021","40601110","40601129","40601137",
  "40601153","40601188","40601196","40601200","40601218","40601226",
  "40601250","40601269","40601285","40701069","40701131","40701140",
  "40703029","40703037","40704025","40704033","40704068","40704076",
  "40704084","40706010","40706028","40707032","40708128","40709027",
  "40709035","40801012","40801020","40801063","40801098","40801110",
  "40801128","40801209","40802019","40802027","40802035","40802043",
  "40802051","40802060","40802078","40802086","40802094","40803015",
  "40803031","40803040","40803058","40803066","40803074","40803082",
  "40803090","40803104","40803112","40803120","40803139","40803147",
  "40804011","40804020","40804038","40804046","40804054","40804062",
  "40804070","40804089","40804097","40804100","40804119","40804127",
  "40804135","40805018","40805026","40806057","40806065","40806081",
  "40807053","40808017","40808025","40808033","40808041","40808130",
  "40808149","40808238","40808254","40809030","40809048","40809161",
  "40811026","40901041","40901068","40901076","40901092","40901106",
  "40901114","40901122","40901130","40901173","40901181","40901203",
  "40901211","40901220","40901238","40901246","40901254","40901262",
  "40901270","40901297","40901300","40901319","40901335","40901360",
  "40901386","40901394","40901408","40901459","40901467","40901475",
  "40901483","40901530","40901700","40901750","40901769","40902048",
  "41001010","41001028","41001036","41001060","41001079","41001095",
  "41001109","41001125","41001141","41001150","41001176","41001184",
  "41001222","41001370","41001389","41001419","41001435","41001451",
  "41001460","41101014","41101022","41101073","41101081","41101103",
  "41101111","41101120","41101170","41101189","41101219","41101227",
  "41101260","41101278","41101294","41101308","41101316","41101359",
  "41101480","41101537","41101545","41101618","41102010","41301013",
  "41301048","41301064","41301072","41301080","41301099","41301102",
  "41301129","41301137","41301153","41301200","41301226","41301242",
  "41301250","41301269","41301285","41301307","41301315","41301323",
  "41301340","41301358","41301471","41401107","41401263","41401476",
  "41401492","41401514","41401646","41501012","41501128","41501144",
  "41501195"),"3-Exames", if_else(
    base_mais$`Procedimento Codigo` %in% c("20103131","20103301",
  "20104049","20104065","20104073","20104081","20104090","20104103",
  "20104235","20104294","20104308","20104316","20203012","20203047",
  "30101077","30101107","30101220","30101271","30101280","30101298",
  "30101441","30101450","30101468","30101492","30101506","30101549",
  "30101611","30101620","30101638","30101646","30101662","30101670",
  "30101735","30101786","30101794","30101832","30101913","30101921",
  "30101930","30101948","30202051","30203015","30204020","30204046",
  "30204097","30205034","30205050","30207126","30207223","30210119",
  "30210127","30212081","30212090","30213045","30213053","30301041",
  "30301084","30301190","30302021","30303010","30303060","30304032",
  "30304083","30304091","30304105","30306019","30306027","30307031",
  "30307058","30307066","30307082","30307090","30307120","30307147",
  "30310032","30310067","30310075","30310083","30310091","30310113",
  "30312043","30313066","30401054","30402018","30402042","30402077",
  "30403154","30501016","30501288","30501369","30501458","30502020",
  "30502080","30502209","30502217","30502233","30502268","30502314",
  "30502322","30502349","30502357","30602076","30602092","30602114",
  "30602130","30602203","30602262","30602300","30710014","30710022",
  "30710030","30710057","30711010","30711029","30711037","30712017",
  "30712025","30712084","30712092","30712122","30715016","30715024",
  "30715091","30715180","30715199","30715229","30715270","30715393",
  "30717086","30717094","30717108","30717140","30718058","30719070",
  "30719100","30720087","30720095","30720125","30721130","30721180",
  "30721199","30721245","30722152","30722292","30722314","30722349",
  "30722373","30722403","30722411","30722420","30724058","30725127",
  "30726018","30726034","30726085","30726093","30726107","30726115",
  "30726182","30726204","30726247","30727120","30728096","30728118",
  "30728126","30728134","30728142","30729033","30729130","30729149",
  "30729157","30729165","30729181","30729203","30731038","30731062",
  "30731089","30731097","30731100","30731119","30731127","30731135",
  "30731160","30731178","30731194","30731208","30731232","30733030",
  "30733049","30733057","30733065","30733073","30734029","30735017",
  "30735025","30735033","30735068","30735084","30735092","30737079",
  "30801095","30904021","30906164","30907136","30909031","30909139",
  "30909147","30910080","30912016","30912105","30913012","30913101",
  "30913144","30914060","31002390","31003079","31003362","31003583",
  "31004091","31004105","31004121","31004148","31004202","31004237",
  "31004300","31005470","31005497","31009042","31009050","31009093",
  "31009107","31009115","31009140","31009166","31009255","31009263",
  "31009336","31101240","31102050","31102077","31102360","31102379",
  "31103332","31103375","31103472","31103561","31104150","31201067",
  "31201113","31201121","31201130","31202020","31202047","31203043",
  "31203060","31203124","31204023","31205046","31205070","31206018",
  "31206050","31206212","31206220","31301037","31301088","31301096",
  "31301100","31301118","31302041","31302050","31303056","31303072",
  "31303102","31303110","31303145","31303153","31303170","31303188",
  "31303196","31303234","31303269","31303293","31304010","31304044",
  "31304087","31305016","31305032","31306055","31307027","31307124",
  "31309054","31309062","31309127","31401031","31403034","31403123",
  "31403280","31403336","31403352","31403360","31601014","31602169",
  "31602231","31602312","31602622","40202283","40202429","40202488",
  "40202542","40202550","40324192","40402045","40808203","40812022",
  "40812030","40812049","40812057","40812073","40813363","40813576",
  "40813720"), "4-Terapias", if_else(base_mais$`Procedimento Codigo` %in% c())))))
